# Day 2 - æ™ºèƒ½ä½“å·¥å…·å’Œæœ€ä½³å®è·µ

æ­¤æ–‡ä»¶å¤¹åŒ…å«åŸºäº Kaggle 5 å¤©æ™ºèƒ½ä½“è¯¾ç¨‹çš„ Day 2 Jupyter ç¬”è®°æœ¬çš„ Python è„šæœ¬ã€‚

## è„šæœ¬æ¦‚è¿°

### 1. `day_2a_agent_tools.py`
**æ™ºèƒ½ä½“å·¥å…· - è‡ªå®šä¹‰å‡½æ•°å’Œå§”æ‰˜**

æ­¤è„šæœ¬æ¼”ç¤ºï¼š
- åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å·¥å…·ï¼ˆè´§å¸è½¬æ¢å™¨ç¤ºä¾‹ï¼‰
- ä½¿ç”¨ Python å‡½æ•°ä½œä¸ºæ™ºèƒ½ä½“å·¥å…·
- æ™ºèƒ½ä½“å·¥å…·æ¨¡å¼ï¼ˆä½¿ç”¨æ™ºèƒ½ä½“ä½œä¸ºå·¥å…·è¿›è¡Œå§”æ‰˜ï¼‰
- å†…ç½®ä»£ç æ‰§è¡Œå™¨ä»¥è¿›è¡Œå¯é è®¡ç®—
- ADK å·¥å…·ç±»å‹çš„å®Œæ•´æŒ‡å—

**å…³é”®æ¦‚å¿µï¼š**
- å‡½æ•°å·¥å…·ï¼šå°†ä»»ä½• Python å‡½æ•°è½¬æ¢ä¸ºæ™ºèƒ½ä½“å·¥å…·
- æ™ºèƒ½ä½“å·¥å…·ï¼šå°†ä»»åŠ¡å§”æ‰˜ç»™ä¸“å®¶æ™ºèƒ½ä½“
- ä»£ç æ‰§è¡Œï¼šæ¯” LLM ç®—æœ¯æ›´å¯é 
- å·¥å…·ç¼–æ’å’Œé”™è¯¯å¤„ç†

**ç¤ºä¾‹ç”¨ä¾‹ï¼š**
- å¸¦è´¹ç”¨è®¡ç®—çš„è´§å¸è½¬æ¢
- å°†å¤æ‚è®¡ç®—å§”æ‰˜ç»™ä¸“å®¶æ™ºèƒ½ä½“
- å·¥å…·ä¸­çš„ä¸šåŠ¡é€»è¾‘å°è£…

### 2. `day_2b_agent_tools_best_practices.py`
**é«˜çº§å·¥å…·æ¨¡å¼ - MCP å’Œé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œ**

æ­¤è„šæœ¬æ¼”ç¤ºï¼š
- æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰é›†æˆæ¦‚å¿µ
- äººå·¥å‚ä¸çš„é•¿æ—¶é—´è¿è¡Œæ“ä½œï¼ˆLROï¼‰
- å¯æš‚åœå’Œå¯æ¢å¤çš„å·¥ä½œæµ
- è·¨è¶Šå¯¹è¯ä¸­æ–­çš„çŠ¶æ€ç®¡ç†
- å…³é”®æ“ä½œçš„å®¡æ‰¹å·¥ä½œæµ

**å…³é”®æ¦‚å¿µï¼š**
- MCPï¼šè¿æ¥åˆ°å¤–éƒ¨æœåŠ¡è€Œæ— éœ€è‡ªå®šä¹‰é›†æˆ
- LROï¼šæš‚åœå·¥ä½œæµä»¥è¿›è¡Œäººå·¥å®¡æ‰¹
- å¯æ¢å¤æ€§ï¼šæš‚åœæ—¶ä¿æŒçŠ¶æ€
- å·¥å…·ä¸Šä¸‹æ–‡ï¼šè®¿é—®å’Œç®¡ç†å®¡æ‰¹çŠ¶æ€

**ç¤ºä¾‹ç”¨ä¾‹ï¼š**
- å¤§æ‰¹é‡éœ€è¦å®¡æ‰¹çš„è´§è¿è®¢å•
- éœ€è¦äººå·¥ç›‘ç£çš„é‡‘èäº¤æ˜“
- å®Œæˆå‰éœ€è¦å¤–éƒ¨è¾“å…¥çš„ä»»ä½•æ“ä½œ

## å…ˆå†³æ¡ä»¶

ç¡®ä¿ä½ å·²å®Œæˆé¡¹ç›®æ ¹ç›®å½•çš„è®¾ç½®ï¼š

```bash
# ä»é¡¹ç›®æ ¹ç›®å½•
source venv/bin/activate  # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
```

å¦‚æœä½ å°šæœªè®¾ç½®é¡¹ç›®ï¼Œè¯·è¿è¡Œï¼š

```bash
cd ..  # è½¬åˆ°é¡¹ç›®æ ¹ç›®å½•
./setup.sh
source venv/bin/activate
```

## è¿è¡Œè„šæœ¬

### è¿è¡Œè„šæœ¬ 2aï¼ˆæ™ºèƒ½ä½“å·¥å…·ï¼‰

```bash
# ç¡®ä¿ä½ åœ¨ Day-2 ç›®å½•ä¸­ä¸” venv å·²æ¿€æ´»
python day_2a_agent_tools.py
```

**å®ƒçš„ä½œç”¨ï¼š**
- åˆ›å»ºå¸¦æœ‰è‡ªå®šä¹‰å·¥å…·çš„è´§å¸è½¬æ¢å™¨æ™ºèƒ½ä½“
- æ¼”ç¤ºç”¨äºè´¹ç”¨å’Œæ±‡ç‡çš„å‡½æ•°å·¥å…·
- æ˜¾ç¤ºå‘è®¡ç®—ä¸“å®¶çš„æ™ºèƒ½ä½“å§”æ‰˜
- æ¯”è¾ƒæ‰‹åŠ¨è®¡ç®—ä¸ä»£ç ç”Ÿæˆçš„è®¡ç®—

### è¿è¡Œè„šæœ¬ 2bï¼ˆæœ€ä½³å®è·µï¼‰

```bash
python day_2b_agent_tools_best_practices.py
```

**å®ƒçš„ä½œç”¨ï¼š**
- è§£é‡Š MCP é›†æˆæ¦‚å¿µ
- æ¼”ç¤ºå¸¦æœ‰å®¡æ‰¹å·¥ä½œæµçš„é•¿æ—¶é—´è¿è¡Œæ“ä½œ
- æµ‹è¯•ä¸‰ä¸ªåœºæ™¯ï¼š
  1. å°è®¢å•ï¼ˆè‡ªåŠ¨æ‰¹å‡†ï¼‰
  2. å¤§è®¢å•ï¼ˆæš‚åœç­‰å¾…å®¡æ‰¹ - æ‰¹å‡†ï¼‰
  3. å¤§è®¢å•ï¼ˆæš‚åœç­‰å¾…å®¡æ‰¹ - æ‹’ç»ï¼‰

**æ³¨æ„ï¼š** MCP éƒ¨åˆ†è§£é‡Šäº†æ¦‚å¿µï¼Œæ— éœ€å®‰è£… Node.jsã€‚è¦å®é™…è¿è¡Œ MCP æœåŠ¡å™¨ï¼Œä½ éœ€è¦å®‰è£… Node.js å’Œ npxã€‚

## ç†è§£è¾“å‡º

### Day 2a è¾“å‡º
ä½ å°†çœ‹åˆ°ï¼š
- æ­£åœ¨è°ƒç”¨çš„è‡ªå®šä¹‰å‡½æ•°å·¥å…·ï¼ˆè´¹ç”¨æŸ¥æ‰¾ã€æ±‡ç‡ï¼‰
- ä½¿ç”¨æ‰‹åŠ¨è®¡ç®—çš„åŸºæœ¬è´§å¸è½¬æ¢
- ä½¿ç”¨ä»£ç ç”Ÿæˆè¿›è¡Œç²¾ç¡®æ•°å­¦è¿ç®—çš„å¢å¼ºè½¬æ¢
- å‘è®¡ç®—ä¸“å®¶çš„æ™ºèƒ½ä½“å§”æ‰˜

### Day 2b è¾“å‡º
ä½ å°†çœ‹åˆ°ï¼š
- MCP æ¶æ„å’Œä½¿ç”¨è¯´æ˜
- é•¿æ—¶é—´è¿è¡Œæ“ä½œå·¥ä½œæµï¼š
  - å°è®¢å•çš„çŠ¶æ€ï¼š"approved"
  - å¤§è®¢å•çš„çŠ¶æ€ï¼š"pending" â†’ æš‚åœ â†’ æ¢å¤
  - äººå·¥å†³ç­–æ¨¡æ‹Ÿï¼ˆæ‰¹å‡†/æ‹’ç»ï¼‰
  - æ¢å¤åçš„æœ€ç»ˆçŠ¶æ€

## å…³é”®æ¨¡å¼å’Œä½¿ç”¨æ—¶æœº

### å‡½æ•°å·¥å…·
**ä½•æ—¶ä½¿ç”¨ï¼š**
- ä½ æœ‰è¦å°è£…çš„ä¸šåŠ¡é€»è¾‘
- ä½ éœ€è¦è‡ªå®šä¹‰è®¡ç®—æˆ–æ•°æ®æŸ¥æ‰¾
- ä½ æƒ³è¦è¿æ¥åˆ°å†…éƒ¨ç³»ç»Ÿ

**æ¨¡å¼ï¼š**
```python
def my_custom_tool(param: str) -> dict:
    """æ¸…æ™°çš„æ–‡æ¡£å­—ç¬¦ä¸²æœ‰åŠ©äº LLM ç†è§£å·¥å…·ã€‚"""
    # ä½ çš„ä¸šåŠ¡é€»è¾‘
    return {"status": "success", "data": result}

agent = LlmAgent(
    tools=[my_custom_tool],  # åªéœ€å°†å‡½æ•°æ·»åŠ åˆ°å·¥å…·åˆ—è¡¨
)
```

### æ™ºèƒ½ä½“å·¥å…·ï¼ˆå§”æ‰˜ï¼‰
**ä½•æ—¶ä½¿ç”¨ï¼š**
- ä»»åŠ¡éœ€è¦ä¸“å®¶ä¸“ä¸šçŸ¥è¯†
- æƒ³è¦åœ¨ç³»ç»Ÿä¸­é‡ç”¨æ™ºèƒ½ä½“
- éœ€è¦æ¨¡å—åŒ–ã€å¯ç»„åˆçš„æ™ºèƒ½ä½“æ¶æ„

**æ¨¡å¼ï¼š**
```python
specialist_agent = LlmAgent(...)  # åˆ›å»ºä¸“å®¶

main_agent = LlmAgent(
    tools=[AgentTool(agent=specialist_agent)],  # ç”¨ä½œå·¥å…·
)
```

### é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œ
**ä½•æ—¶ä½¿ç”¨ï¼š**
- éœ€è¦å®¡æ‰¹çš„é‡‘èäº¤æ˜“
- éœ€è¦ç¡®è®¤çš„æ‰¹é‡æ“ä½œ
- åˆè§„æ£€æŸ¥ç‚¹
- å¿…é¡»æš‚åœç­‰å¾…å¤–éƒ¨è¾“å…¥çš„ä»»ä½•æ“ä½œ

**æ¨¡å¼ï¼š**
```python
def my_pausable_tool(param: str, tool_context: ToolContext) -> dict:
    if needs_approval:
        tool_context.request_confirmation(hint="Approve?")
        return {"status": "pending"}

    if tool_context.tool_confirmation.confirmed:
        # å·²æ‰¹å‡† - ç»§ç»­
        return {"status": "approved"}

# å°†æ™ºèƒ½ä½“åŒ…è£…åœ¨å…·æœ‰å¯æ¢å¤æ€§çš„ App ä¸­
app = App(
    root_agent=agent,
    resumability_config=ResumabilityConfig(is_resumable=True),
)
```

## å·¥å…·ç±»å‹å¿«é€Ÿå‚è€ƒ

| å·¥å…·ç±»å‹ | å®ƒçš„ä½œç”¨ | ç”¨ä¾‹ |
|-----------|-------------|----------|
| **å‡½æ•°å·¥å…·** | Python å‡½æ•°ä½œä¸ºå·¥å…· | è‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘ |
| **æ™ºèƒ½ä½“å·¥å…·** | æ™ºèƒ½ä½“ä½œä¸ºå·¥å…· | å§”æ‰˜ã€ä¸“ä¸šåŒ– |
| **ä»£ç æ‰§è¡Œå™¨** | è¿è¡Œ Python ä»£ç  | å¯é è®¡ç®— |
| **MCP å·¥å…·** | å¤–éƒ¨æœåŠ¡é›†æˆ | GitHubã€Slackã€æ•°æ®åº“ |
| **é•¿æ—¶é—´è¿è¡Œ** | å¯æš‚åœæ“ä½œ | äººå·¥å®¡æ‰¹ã€è·¨è¶Šæ—¶é—´çš„ä»»åŠ¡ |

## å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ï¼š"Tool not found" æˆ–æ™ºèƒ½ä½“ä¸ä½¿ç”¨å·¥å…·
**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥å·¥å…·çš„æ–‡æ¡£å­—ç¬¦ä¸²æ˜¯å¦æ¸…æ™°ä¸”å…·æœ‰æè¿°æ€§
- ç¡®ä¿æ™ºèƒ½ä½“æŒ‡ä»¤ä¸­çš„å·¥å…·åç§°ä¸å‡½æ•°åç§°åŒ¹é…
- éªŒè¯å·¥å…·åœ¨æ™ºèƒ½ä½“çš„ `tools=[]` åˆ—è¡¨ä¸­

### é—®é¢˜ï¼šé•¿æ—¶é—´è¿è¡Œæ“ä½œä¸æš‚åœ
**è§£å†³æ–¹æ¡ˆï¼š**
- éªŒè¯å‡½æ•°ç­¾åä¸­çš„ `tool_context: ToolContext` å‚æ•°
- æ£€æŸ¥ App æ˜¯å¦å¯ç”¨äº† `resumability_config`
- ç¡®ä¿ä½ ä½¿ç”¨çš„æ˜¯å¸¦æœ‰ `app=` è€Œä¸æ˜¯ `agent=` çš„ `Runner`

### é—®é¢˜ï¼šæ™ºèƒ½ä½“ç»™å‡ºé”™è¯¯çš„è®¡ç®—
**è§£å†³æ–¹æ¡ˆï¼š**
- ä½¿ç”¨æ™ºèƒ½ä½“å·¥å…·æ¨¡å¼å§”æ‰˜ç»™ä»£ç ç”Ÿæˆä¸“å®¶
- å°† `code_executor=BuiltInCodeExecutor()` æ·»åŠ åˆ°è®¡ç®—æ™ºèƒ½ä½“
- æŒ‡ç¤ºæ™ºèƒ½ä½“ç”Ÿæˆä»£ç ï¼Œè€Œä¸æ˜¯ç›´æ¥è®¡ç®—

## å­¦ä¹ èµ„æº

- [ADK å·¥å…·æ–‡æ¡£](https://google.github.io/adk-docs/tools/)
- [ADK å‡½æ•°å·¥å…·æŒ‡å—](https://google.github.io/adk-docs/tools/function-tools/)
- [ADK MCP å·¥å…·](https://google.github.io/adk-docs/tools/mcp-tools/)
- [æ¨¡å‹ä¸Šä¸‹æ–‡åè®®](https://modelcontextprotocol.io/)
- [ADK è¿è¡Œæ—¶ï¼ˆä¼šè¯ã€è¿è¡Œå™¨ï¼‰](https://google.github.io/adk-docs/runtime/)

## æœ€ä½³å®è·µ

### ç¼–å†™è‰¯å¥½çš„å·¥å…·å‡½æ•°

1. **æ¸…æ™°çš„æ–‡æ¡£å­—ç¬¦ä¸²ï¼š** LLM ä½¿ç”¨è¿™äº›æ¥ç†è§£ä½•æ—¶/å¦‚ä½•ä½¿ç”¨å·¥å…·
```python
def my_tool(param: str) -> dict:
    """æ­¤å·¥å…·åŠŸèƒ½çš„ç®€è¦æè¿°ã€‚

    Args:
        param: æ¸…æ™°çš„å‚æ•°æè¿°

    Returns:
        åŒ…å«çŠ¶æ€å’Œæ•°æ®çš„å­—å…¸
    """
```

2. **ç±»å‹æç¤ºï¼š** å¯ç”¨æ­£ç¡®çš„æ¨¡å¼ç”Ÿæˆ
```python
def my_tool(count: int, name: str) -> dict:
    # ADK ä½¿ç”¨ç±»å‹æç¤ºæ¥éªŒè¯è¾“å…¥
```

3. **ç»“æ„åŒ–è¿”å›ï¼š** å§‹ç»ˆè¿”å›å¸¦æœ‰çŠ¶æ€çš„å­—å…¸
```python
# æˆåŠŸ
return {"status": "success", "data": result}

# é”™è¯¯
return {"status": "error", "error_message": "What went wrong"}
```

4. **é”™è¯¯å¤„ç†ï¼š** ä¼˜é›…åœ°å¤„ç†å¼‚å¸¸
```python
try:
    result = risky_operation()
    return {"status": "success", "data": result}
except Exception as e:
    return {"status": "error", "error_message": str(e)}
```

### å·¥å…·å‘½åçº¦å®š

- ä½¿ç”¨æè¿°æ€§çš„ã€åŸºäºåŠ¨è¯çš„åç§°ï¼š`get_exchange_rate`ã€`place_order`
- å…·ä½“åŒ–ï¼š`calculate_shipping_cost` vs `calculate`
- åŒ¹é…ä¸šåŠ¡é¢†åŸŸè¯­è¨€

### å·¥å…·çš„æ™ºèƒ½ä½“æŒ‡ä»¤

- æŒ‰ç¡®åˆ‡çš„å‡½æ•°åç§°å¼•ç”¨å·¥å…·
- è§£é‡Šä½•æ—¶ä½¿ç”¨æ¯ä¸ªå·¥å…·
- å¦‚æœé¡ºåºå¾ˆé‡è¦ï¼ŒæŒ‡å®šå·¥å…·è°ƒç”¨çš„é¡ºåº
- æè¿°å¦‚ä½•å¤„ç†å·¥å…·é”™è¯¯

## é«˜çº§ï¼šMCP é›†æˆ

è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ MCP æœåŠ¡å™¨ï¼ˆéœ€è¦ Node.jsï¼‰ï¼š

```python
from google.adk.tools.mcp_tool.mcp_toolset import McpToolset
from mcp import StdioServerParameters

# ç¤ºä¾‹ï¼šEverything MCP æœåŠ¡å™¨
mcp_server = McpToolset(
    connection_params=StdioConnectionParams(
        server_params=StdioServerParameters(
            command="npx",
            args=["-y", "@modelcontextprotocol/server-everything"],
        ),
        timeout=30,
    )
)

agent = LlmAgent(
    tools=[mcp_server],
)
```

å¯ç”¨çš„ MCP æœåŠ¡å™¨ï¼š
- **Kaggle**ï¼šæ•°æ®é›†å’Œç¬”è®°æœ¬æ“ä½œ
- **GitHub**ï¼šä»“åº“å’Œ PR ç®¡ç†
- **Google Maps**ï¼šä½ç½®æœåŠ¡
- **Slack**ï¼šå›¢é˜Ÿæ²Ÿé€š
- æ›´å¤šè¯·è®¿é—® [modelcontextprotocol.io/examples](https://modelcontextprotocol.io/examples)

## ä¸‹ä¸€æ­¥

å®Œæˆ Day 2 åï¼š
- ä½ äº†è§£å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰æ™ºèƒ½ä½“å·¥å…·
- ä½ å¯ä»¥å°†ä»»åŠ¡å§”æ‰˜ç»™ä¸“å®¶æ™ºèƒ½ä½“
- ä½ çŸ¥é“å¦‚ä½•å®ç°å®¡æ‰¹å·¥ä½œæµ
- ä½ å·²å‡†å¤‡å¥½è¿›å…¥ Day 3ï¼šçŠ¶æ€å’Œå†…å­˜ç®¡ç†

**ç»§ç»­å­¦ä¹ ï¼š**
- æŸ¥çœ‹ Day 2 ç¬”è®°æœ¬ä»¥è·å–è¯¦ç»†è¯´æ˜
- å°è¯•ä½¿ç”¨ä½ è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ä¿®æ”¹ç¤ºä¾‹
- æ¢ç´¢ ADK æ–‡æ¡£ä»¥è·å–æ›´å¤šå·¥å…·ç±»å‹

ç¥ä½ ç¼–ç æ„‰å¿«ï¼ğŸš€
